<!doctype html>
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if IE 9]>    <html class="no-js ie9" lang="en"> <![endif]-->
<!-- Consider adding an manifest.appcache: h5bp.com/d/Offline -->
<!--[if gt IE 9]><!--> <html class="no-js" lang="en" itemscope itemtype="http://schema.org/Product"> <!--<![endif]-->
<head>
  <meta charset="utf-8">

  <!-- Use the .htaccess and remove these lines to avoid edge case issues.
       More info: h5bp.com/b/378 -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <title>列's Enjoy!!</title>
  <meta name="description" content="" />
  <meta name="keywords" content="" />
  <meta name="author" content="humans.txt">

  <link rel="shortcut icon" href="favicon.png" type="image/x-icon" />

  <!-- Facebook Metadata /-->
  <meta property="fb:page_id" content="" />
  <meta property="og:image" content="" />
  <meta property="og:description" content=""/>
  <meta property="og:title" content=""/>

  <!-- Google+ Metadata /-->
  <meta itemprop="name" content="">
  <meta itemprop="description" content="">
  <meta itemprop="image" content="">

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <!-- We highly recommend you use SASS and write your custom styles in sass/_custom.scss.
     However, there is a blank style.css in the css directory should you prefer -->
  <link rel="stylesheet" href="css/gumby.css">
  <link rel="stylesheet" href="css/custom.css">

  <script src="js/libs/modernizr-2.6.2.min.js"></script>
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
  <script type="text/javascript" src="https://skyway.io/dist/0.3/peer.js"></script>
  <script src="js/use_peer.js"></script>
  <script>
    var meObj = JSON.parse(localStorage.getItem("me"));
    var stateList = {};
    var storeList = {};
    var storeNameList = {};
    
    	function getState(id){
		var state_name = "";
		switch (id){
			case "1":
				state_name = "北海道";
				break;
			case "2":
				state_name = "青森県";
				break;
			case "3":
				state_name = "岩手県";
				break;
			case "4":
				state_name = "宮城県";
				break;
			case "5":
				state_name = "秋田県";
				break;
			case "6":
				state_name = "山形県";
				break;
			case "7":
				state_name = "福島県";
				break;
			case "8":
				state_name = "茨城県";
				break;
			case "9":
				state_name = "栃木県";
				break;
			case "10":
				state_name = "群馬県";
				break;
			case "11":
				state_name = "埼玉県";
				break;
			case "12":
				state_name = "千葉県";
				break;
			case "13":
				state_name = "東京都";
				break;
			case "14":
				state_name = "神奈川県";
				break;
			case "15":
				state_name = "新潟県";
				break;
			case "16":
				state_name = "富山県";
				break;
			case "17":
				state_name = "石川県";
				break;
			case "18":
				state_name = "福井県";
				break;
			case "19":
				state_name = "山梨県";
				break;
			case "20":
				state_name = "長野県";
				break;
			case "21":
				state_name = "岐阜県";
				break;
			case "22":
				state_name = "静岡県";
				break;
			case "23":
				state_name = "愛知県";
				break;
			case "24":
				state_name = "三重県";
				break;
			case "25":
				state_name = "滋賀県";
				break;
			case "26":
				state_name = "京都府";
				break;
			case "27":
				state_name = "大阪府";
				break;
			case "28":
				state_name = "兵庫県";
				break;
			case "29":
				state_name = "奈良県";
				break;
			case "30":
				state_name = "和歌山県";
				break;
			case "31":
				state_name = "鳥取県";
				break;
			case "32":
				state_name = "島根県";
				break;
			case "33":
				state_name = "岡山県";
				break;
			case "34":
				state_name = "広島県";
				break;
			case "35":
				state_name = "山口県";
				break;
			case "36":
				state_name = "徳島県";
				break;
			case "37":
				state_name = "香川県";
				break;
			case "38":
				state_name = "愛媛県";
				break;
			case "39":
				state_name = "高知県";
				break;
			case "40":
				state_name = "福岡県";
				break;
			case "41":
				state_name = "佐賀県";
				break;
			case "42":
				state_name = "長崎県";
				break;
			case "43":
				state_name = "熊本県";
				break;
			case "44":
				state_name = "大分県";
				break;
			case "45":
				state_name = "宮崎県";
				break;
			case "46":
				state_name = "鹿児島県";
				break;
			case "47":
				state_name = "沖縄県";
				break;
		}
		return state_name;
	}

	function sort(targetArray, rankArray, idArray){
    	  var RankInFlag = false;
    	      for (var index in targetArray){
    	            RankInFlag = false;
        	        for(i = 0 ; i < 5 ; i++){
        	          if(!RankInFlag){
            	           if(rankArray[i] <= targetArray[index]){
            	                for(x = 4; x > i; x--){
                  	                rankArray[x] = rankArray[x - 1];
                  	                idArray[x] = idArray[x - 1];
            	                }
                	            rankArray[i] = targetArray[index];
                	            idArray[i] = index;
                	            RankInFlag = true;
            	           }
        	          }
        	          if(!RankInFlag){
            	          if(rankArray.length <= i){
            	            rankArray[i] = targetArray[index];
            	            idArray[i] = index;
            	            RankInFlag = true;
            	          }
        	          }
        	        }
    	        }
	}

	function getStateRanking(targetArray, viewId){
		var rtnRankArray = new Array();
		var rtnIdArray = new Array()
		sort(targetArray, rtnRankArray, rtnIdArray);
		
		for(no = 0; no < 5; no++){
			if(rtnRankArray[no]){
    	        		$(viewId).append('<tr><td>' + (no + 1) + '</td>' + 
                                     '<td class="content-name">' + getState(rtnIdArray[no]) + '</td>' +
                                     '<td>' + rtnRankArray[no] + "人" + '</td></tr>');
			}else{
				break;
			}
    	      }
		
		
	}
	
	function getCheckInRanking(targetArray, targetNameArray, viewId){
		var rtnRankArray = new Array();
		var rtnIdArray = new Array()
		sort(targetArray, rtnRankArray, rtnIdArray);
	  
		for(no = 0; no < 5; no++){
			if(rtnRankArray[no]){
				$(viewId).append('<tr><td>' + (no + 1) + '</td>' + 
		                     '<td class="content-name">' + targetNameArray[rtnIdArray[no]] + '</td>' +
		                     '<td>' + rtnRankArray[no] + "人" + '</td></tr>');
			}else{
				break;
			}
		}
	}
  	
    $(window).load(function(){
 	    // ユーザデータの保存
	getPeerIdList();
	
	var storeList = new Array();
	var storeNameList = new Array();
	var stateList = new Array();
	
	// localStrageのデータ全件から店データだけ取得する例  
	for(var i = 0; i < localStorage.length; i++){
		// キー名の取得
		var k = localStorage.key(i);
		
		if((k.search('user_')) > -1){
			// 値の取得
			var v = JSON.parse(localStorage.getItem(k));
			if(storeList[v.store_id]){
				storeList[v.store_id] ++;
			}else{
				storeList[v.store_id] = 1;
				storeNameList[v.store_id] = v.store_name;
			}
			
			if(stateList[v.state]){
				stateList[v.state]++;
			}else{
				stateList[v.state] = 1;
			}
		}
	}
 	    
	getCheckInRanking(storeList, storeNameList, '#chackInRank');
	getStateRanking(stateList, '#stateRank')
    });
    
  </script>
</head>

<style>
  .btn,.drawer { margin-bottom:10px; }
  .drawer { text-align: center; }
  h1.lead { border-bottom: 1px dotted #ccc; margin-bottom: 30px; }
  h4.lead { margin-bottom:10px; }
  #icon_map ul li { font-size: 16px; }
  .smallify { font-size: 13px; }
  .modal h2, .modal .btn { margin: 5% 0 20px; }
  .ttip.example { float: left; background: #eee; border: 1px dotted #ccc; padding: 20px; }
</style>

<body>

  <!-- Grab Google CDN's jQuery, fall back to local if offline -->
  <!-- 2.0 for modern browsers, 1.10 for .oldie -->
  <script>
  var oldieCheck = Boolean(document.getElementsByTagName('html')[0].className.match(/\soldie\s/g));
  if(!oldieCheck) {
  document.write('<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js"><\/script>');
  } else {
  document.write('<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"><\/script>');
  }
  </script>
  <script>
  if(!window.jQuery) {
  if(!oldieCheck) {
    document.write('<script src="js/libs/jquery-2.0.2.min.js"><\/script>');
  } else {
    document.write('<script src="js/libs/jquery-1.10.1.min.js"><\/script>');
  }
  }
  </script>
  
  <!--{共通ヘッダー ここから}-->
  <header class="navbar" id="nav1">
    <div class="row">
      <a class="toggle" gumby-trigger="#nav1 > .row > ul" href="#"><i class="icon-menu"></i></a>
      <h1 class="four columns logo">
        <a href="index.html">
          <img src="img/header_logo.png" gumby-retina />
        </a>
      </h1>
      <ul class="eight columns">
        <li id="header-menu-chat"><a href="chat.html"><i class="icon-chat"></i> チャット</a></li>
        <li><a href="map.html"><i class="icon-globe"></i> 行列MAP</a></li>
        <li><a href="ranking.html"><i class="icon-trophy"></i> ランキング</a></li>
        <li id="header-menu-edit_profile"><a href="edit_profile.html"><i class="icon-user"></i> プロフィール編集</a></li>
        <li id="header-menu-game"><a href="game.html"><i class="icon-star"></i> しりとり</a></li>
        <li id="header-menu-checkout"><a href="checkout.html"><i class="icon-logout"></i> チェックアウト</a></li>
        <script src="js/display-controll.js"></script>
      </ul>
    </div>
  </header>
  <!--{共通ヘッダー ここまで}-->
  <div class="wrapper">





  <!--{コンテンツ ここから}-->
  <div class="row page-header">
    <div class="twelve columns">
      <h3><i class="icon-trophy"></i> ランキング</h3>
    </div>
  </div>
  <div class="row">
    <div class="twelve columns">
      <table class="striped rounded ranking">
        <thead>
          <tr>
            <td colspan="3"><i class="icon-location"></i> チェックイン数</td>
          </tr>
        </thead>
        <tbody id="chackInRank">
        </tbody>
      </table>
      <table class="striped rounded ranking">
        <thead>
          <tr>
            <td colspan="3"><i class="icon-map"></i> 行列好き都道府県</td>
          </tr>
        </thead>
        <tbody id="stateRank">
         
        </tbody>
      </table>
    </div>
  </div>
  <!--{コンテンツ ここまで}-->




  </div>
  <div class="footer-fix"></div>
  </div>
  <!--{共通フッター ここから}-->
  <footer class="row footer">
    PRO Team @DEVCAMP 2014
  </footer>
  <!--{共通フッター ここまで}-->
  <!--
  Include gumby.js followed by UI modules followed by gumby.init.js
  Or concatenate and minify into a single file -->
  <script gumby-touch="js/libs" src="js/libs/gumby.js"></script>
  <script src="js/libs/ui/gumby.retina.js"></script>
  <script src="js/libs/ui/gumby.fixed.js"></script>
  <script src="js/libs/ui/gumby.skiplink.js"></script>
  <script src="js/libs/ui/gumby.toggleswitch.js"></script>
  <script src="js/libs/ui/gumby.checkbox.js"></script>
  <script src="js/libs/ui/gumby.radiobtn.js"></script>
  <script src="js/libs/ui/gumby.tabs.js"></script>
  <script src="js/libs/ui/gumby.navbar.js"></script>
  <script src="js/libs/ui/jquery.validation.js"></script>
  <script src="js/libs/gumby.init.js"></script>

  <!--
  Google's recommended deferred loading of JS
  gumby.min.js contains gumby.js, all UI modules and gumby.init.js

  Note: If you opt to use this method of defered loading,
  ensure that any javascript essential to the initial
  display of the page is included separately in a normal
  script tag.

  <script type="text/javascript">
  function downloadJSAtOnload() {
  var element = document.createElement("script");
  element.src = "js/libs/gumby.min.js";
  document.body.appendChild(element);
  }
  if (window.addEventListener)
  window.addEventListener("load", downloadJSAtOnload, false);
  else if (window.attachEvent)
  window.attachEvent("onload", downloadJSAtOnload);
  else window.onload = downloadJSAtOnload;
  </script> -->

  <script src="js/plugins.js"></script>
  <script src="js/main.js"></script>

  <!-- Change UA-XXXXX-X to be your site's ID -->
  <!--<script>
  window._gaq = [['_setAccount','UAXXXXXXXX1'],['_trackPageview'],['_trackPageLoadTime']];
  Modernizr.load({
    load: ('https:' == location.protocol ? '//ssl' : '//www') + '.google-analytics.com/ga.js'
  });
  </script>-->

  <!-- Prompt IE 6 users to install Chrome Frame. Remove this if you want to support IE 6.
     chromium.org/developers/how-tos/chrome-frame-getting-started -->
  <!--[if lt IE 7 ]>
  <script src="//ajax.googleapis.com/ajax/libs/chrome-frame/1.0.3/CFInstall.min.js"></script>
  <script>window.attachEvent('onload',function(){CFInstall.check({mode:'overlay'})})</script>
  <![endif]-->

  </body>
</html>
